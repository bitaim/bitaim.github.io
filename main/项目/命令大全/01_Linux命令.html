<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux | 山  海</title>
    <meta name="description" content="">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.032ce348.css" as="style"><link rel="preload" href="/assets/js/app.daf90e44.js" as="script"><link rel="preload" href="/assets/js/2.5c2f89f7.js" as="script"><link rel="preload" href="/assets/js/51.40d31a4d.js" as="script"><link rel="prefetch" href="/assets/js/10.060e2bf0.js"><link rel="prefetch" href="/assets/js/11.2c1e7667.js"><link rel="prefetch" href="/assets/js/12.e4112fb1.js"><link rel="prefetch" href="/assets/js/13.c48f2af3.js"><link rel="prefetch" href="/assets/js/14.4c74936a.js"><link rel="prefetch" href="/assets/js/15.dde0f892.js"><link rel="prefetch" href="/assets/js/16.04fdeec3.js"><link rel="prefetch" href="/assets/js/17.50a51165.js"><link rel="prefetch" href="/assets/js/18.8ae9a823.js"><link rel="prefetch" href="/assets/js/19.ccac1f50.js"><link rel="prefetch" href="/assets/js/20.dc3b4da0.js"><link rel="prefetch" href="/assets/js/21.537f2917.js"><link rel="prefetch" href="/assets/js/22.fa0e5570.js"><link rel="prefetch" href="/assets/js/23.dbc6b9de.js"><link rel="prefetch" href="/assets/js/24.86da2a97.js"><link rel="prefetch" href="/assets/js/25.8db6665f.js"><link rel="prefetch" href="/assets/js/26.7ff0ce90.js"><link rel="prefetch" href="/assets/js/27.498e5d1f.js"><link rel="prefetch" href="/assets/js/28.c7a49776.js"><link rel="prefetch" href="/assets/js/29.3f057de0.js"><link rel="prefetch" href="/assets/js/3.b7af9e84.js"><link rel="prefetch" href="/assets/js/30.15140778.js"><link rel="prefetch" href="/assets/js/31.e91d7705.js"><link rel="prefetch" href="/assets/js/32.e8b9f267.js"><link rel="prefetch" href="/assets/js/33.9d40e450.js"><link rel="prefetch" href="/assets/js/34.7c76fee5.js"><link rel="prefetch" href="/assets/js/35.893bc59e.js"><link rel="prefetch" href="/assets/js/36.13ad14c2.js"><link rel="prefetch" href="/assets/js/37.7b7d3440.js"><link rel="prefetch" href="/assets/js/38.93ac778e.js"><link rel="prefetch" href="/assets/js/39.10b0f4fe.js"><link rel="prefetch" href="/assets/js/4.11dd4e91.js"><link rel="prefetch" href="/assets/js/40.464abc1f.js"><link rel="prefetch" href="/assets/js/41.29e1fdca.js"><link rel="prefetch" href="/assets/js/42.415177f1.js"><link rel="prefetch" href="/assets/js/43.422cbd1e.js"><link rel="prefetch" href="/assets/js/44.f9780e88.js"><link rel="prefetch" href="/assets/js/45.2731c44f.js"><link rel="prefetch" href="/assets/js/46.eb287d68.js"><link rel="prefetch" href="/assets/js/47.a3668e5f.js"><link rel="prefetch" href="/assets/js/48.892840a4.js"><link rel="prefetch" href="/assets/js/49.b7d6cbaf.js"><link rel="prefetch" href="/assets/js/5.e02fc35f.js"><link rel="prefetch" href="/assets/js/50.06cadfd1.js"><link rel="prefetch" href="/assets/js/52.33a7f0cc.js"><link rel="prefetch" href="/assets/js/53.13a99099.js"><link rel="prefetch" href="/assets/js/54.d6a76531.js"><link rel="prefetch" href="/assets/js/55.d31ae64c.js"><link rel="prefetch" href="/assets/js/56.805fbd61.js"><link rel="prefetch" href="/assets/js/57.b457ef1b.js"><link rel="prefetch" href="/assets/js/58.372ee965.js"><link rel="prefetch" href="/assets/js/59.3ef115d3.js"><link rel="prefetch" href="/assets/js/6.41be9e56.js"><link rel="prefetch" href="/assets/js/60.87fd023f.js"><link rel="prefetch" href="/assets/js/61.86290fe0.js"><link rel="prefetch" href="/assets/js/62.5f84a20b.js"><link rel="prefetch" href="/assets/js/63.7baf0019.js"><link rel="prefetch" href="/assets/js/7.96ae93e8.js"><link rel="prefetch" href="/assets/js/8.30d5150e.js"><link rel="prefetch" href="/assets/js/9.04db00b8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.032ce348.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">山  海</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/main/项目/" class="nav-link">导航栏</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/main/项目/" class="nav-link">导航栏</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/main/项目/命令大全/01_Linux命令.html" class="active sidebar-link">Linux</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/main/项目/命令大全/02_Git命令.html" class="sidebar-link">Git命令</a></li><li><a href="/main/项目/命令大全/03_SQL命令.html" class="sidebar-link">SQL命令</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="linux"><a href="#linux" class="header-anchor">#</a> Linux</h1> <h3 id="启动java服务"><a href="#启动java服务" class="header-anchor">#</a> 启动Java服务</h3> <p>  指令：<code>nohup java -jar -Dfile.encoding=UTF-8 hermes.jar 1&gt;/dev/null 2&gt;&amp;1 &amp;</code>，启动Java服务。</p> <p>  （1）<code>-D</code>指定系统参数，在程序中可以通过<code>System.getProperty(&quot;file.encoding&quot;)</code>获取值。</p> <p>  （2）<code>1&gt;/dev/null 2&gt;&amp;1</code>，不生成日志。</p> <p>  （3）<code>nohup ... &amp;</code>，后台启动。</p> <p>  指令：<code>kill -15 &lt;pid&gt;</code>，关闭Java服务，Java服务会回调钩子函数正常完成退出逻辑。<code>kill -9 &lt;pid&gt;</code>是强制杀死一个进程，会导致数据丢失的问题。</p> <h3 id="编辑命令-vi"><a href="#编辑命令-vi" class="header-anchor">#</a> 编辑命令 vi</h3> <p>  （1）指令：<code>:/ &lt;keyword&gt;</code>，查询内容，<code>n</code>搜索下一个，<code>N（shift + n）</code>搜索上一个。</p> <p>  （2）指令：<code>gg</code>，定位到第一行。</p> <p>  （3）指令：<code>G</code>，定位到最后一行。</p> <p>  （4）指令：<code>: 666</code>，跳转到第666行。</p> <p>  （5）指令：<code>:set nu</code>，显示行号。</p> <p>  （6）指令：<code>:set nonu</code>，关闭行号。</p> <h3 id="开放端口"><a href="#开放端口" class="header-anchor">#</a> 开放端口</h3> <p>  （1）指令：<code>sudo firewall-cmd --list-ports</code>，查看已开放端口。</p> <p>  （2）指令：<code>sudo firewall-cmd --zone=public --add-port=80/tcp --permanent</code>，开放80端口。</p> <p>  （3）指令：<code>sudo firewall-cmd --reload</code>，重启防火墙，使配置生效。</p> <h3 id="磁盘占用"><a href="#磁盘占用" class="header-anchor">#</a> 磁盘占用</h3> <p>  磁盘占用大多数情况是日志文件太多了，删除一些日志文件即可。在生产环境中，注意tomcat和nginx输出日志按天切割，通过shell脚本定期删除7天前旧的日志文件。</p> <p>  （1）指令：<code>df -h</code>，查看磁盘使用情况。</p> <p>  （2）指令：<code>find / -size +100M |xargs ls -lh</code>，寻找根目录下大于100MB的文件。如果存在大量小文件，那么还是解决不了问题。</p> <p>  （3）指令：<code>du -sh *</code>，显示当前目录下各个文件夹的磁盘空间所占大小。</p> <p>  （4）指令：<code>du -h &gt;fs_du.log</code>，查看各个目录占用的磁盘空间大小，定位哪个目录是不是有大量小文件。</p> <h3 id="定位-cpu100"><a href="#定位-cpu100" class="header-anchor">#</a> 定位 CPU100%</h3> <p>  （1）指令：<code>top -c</code>，定位耗费CPU进程，显示进程列表，按<code>P</code>可按照CPU使用率排序。</p> <p>  （2）指令：<code>top -Hp &lt;进程ID&gt;</code>，定位耗费CPU线程，按<code>P</code>可按照CPU使用率排序。</p> <p>  （3）指令：<code>printf &quot;%x\n&quot; &lt;线程ID&gt;</code>，定位耗费CPU代码，将线程ID以16进制输出。</p> <p>  （4）指令：<code>jstack &lt;进程ID&gt; | grep &lt;16进制的线程ID&gt; -C5 --color</code>，用jstack打印堆栈信息，根据堆栈信息就可以定位到哪个进程的哪个线程的哪段代码导致的CPU负载过高。</p> <p>  （5）指令：<code>top</code>的参数<code>load average</code>。显示的是1分钟 5分钟 15分钟的CPU加载的数量，与CPU的核数相当，如果是2核的服务器，参数不要超过2就好，如果是2以上，代表CPU处于阻塞状态，该参数值越低越好。</p> <h3 id="杀掉僵尸进程"><a href="#杀掉僵尸进程" class="header-anchor">#</a> 杀掉僵尸进程</h3> <p>  通过<code>kill</code>指令无法杀掉一个进程时，代表这个进程成为了僵尸进程。因为这个进程释放了资源，但却没有得到父进程的确认。</p> <p>  （1）指令：<code>ps aux</code>，查看STAT，如果显示是Z，代表是僵尸进程。</p> <p>  （2）指令：<code>ps -ef | grep &lt;僵尸进程id&gt;</code>，找到父进程ID，先杀掉父进程，在杀掉子进程即可。</p> <p>  （3）指令：<code>pstree -p &lt;进程号&gt;</code>，可以看到该进程的线程。</p> <p>  （4）指令：<code>pstree -p &lt;进程号&gt; | wc -l</code>，可以看到该进程的线程的数量。</p> <h3 id="定时任务"><a href="#定时任务" class="header-anchor">#</a> 定时任务</h3> <p>  （1）指令：<code>systemctl status crond</code>，查看定时任务是否开启。</p> <p>  （2）指令：<code>systemctl start crond</code>，启动定时任务。</p> <p>  （3）指令：<code>crontab -l</code>，查看定时任务列表。</p> <p>  （4）指令：<code>crontab -e</code>，编辑定时任务列表（直接生效）。</p> <h3 id="复制命令"><a href="#复制命令" class="header-anchor">#</a> 复制命令</h3> <p>  （1）指令：<code>cp dir1/a.doc dir2</code>。</p> <p>  （2）指令：<code>cp -r dir1 dir2</code>。</p> <p>  （3）指令：<code>cp -r dir1/. dir2</code>。</p> <p>  参数<code>-i</code>，询问如果已存在同名文件，是否进行覆盖。</p> <h3 id="查看端口"><a href="#查看端口" class="header-anchor">#</a> 查看端口</h3> <p>  （1）指令：<code>netstat -anp | grep 5990</code>，查看5990端口的占用（使用）情况。</p> <div class="language- extra-class"><pre class="language-text"><code>tcp6     0      0 :::5990                 :::*                    LISTEN       8345/java
tcp6     0      0 172.16.15.233:5990      192.168.4.126:46052     ESTABLISHED  8345/java
tcp6     0      0 172.16.15.233:5990      192.168.4.126:44228     ESTABLISHED  8345/java
tcp6     0      0 172.16.15.233:5990      192.168.4.17:35078      ESTABLISHED  8345/java
tcp6     0      0 172.16.15.233:5990      192.168.4.126:53195     ESTABLISHED  8345/java
tcp6     0      0 172.16.15.233:5990      192.168.4.126:46043     ESTABLISHED  8345/java
tcp6     0      0 172.16.15.233:5990      192.168.4.17:45708      ESTABLISHED  8345/java
</code></pre></div><p>  可以看到<code>172.16.15.233</code>服务器上的某个服务使用了5990端口，并和右侧的一列服务器建立了连接。</p> <p>  （2）指令：<code>netstat -anp | grep 5990 | wc -l</code>，查看5990端口对外建立连接的数量。</p> <h3 id="路由表"><a href="#路由表" class="header-anchor">#</a> 路由表</h3> <p>  指令：<code>route -n</code>，查看路由表。如果显示<code>route：未找到命令</code>，可以通过指令：<code>yum install net-tools</code>安装插件。</p> <div class="language- extra-class"><pre class="language-text"><code>Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.29.2    0.0.0.0         UG    100    0        0 ens33
192.168.29.0    0.0.0.0         255.255.255.0   U     100    0        0 ens33
</code></pre></div><h3 id="目录介绍"><a href="#目录介绍" class="header-anchor">#</a> 目录介绍</h3> <p>  目录：<code>/etc/</code>，是用来存储配置。</p> <p>  目录：<code>/var/</code>，是用来存储软件运行时产生的一些数据。</p> <h3 id="系统调用"><a href="#系统调用" class="header-anchor">#</a> 系统调用</h3> <p>  指令：<code>yum install man-pages -y</code></p> <p>  指令：<code>man syscalls</code></p> <h3 id="文件"><a href="#文件" class="header-anchor">#</a> 文件</h3> <p>  查看磁盘剩余空间：<code>df -h</code></p> <p>  查找家目录下大于100MB的大文件：<code>find ~ -size +100M</code></p> <p>  清空大文件内容：<code>echo &quot;&quot; &gt; zookeeper.out</code></p> <h3 id="端口号"><a href="#端口号" class="header-anchor">#</a> 端口号</h3> <p>  查看端口号是否被占用：<code>ps -ef | grep 8080</code></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/main/项目/命令大全/02_Git命令.html">Git命令</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.daf90e44.js" defer></script><script src="/assets/js/2.5c2f89f7.js" defer></script><script src="/assets/js/51.40d31a4d.js" defer></script>
  </body>
</html>
