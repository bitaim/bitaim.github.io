(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{282:function(t,_,v){"use strict";v.r(_);var a=v(0),s=Object(a.a)({},(function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"原理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[t._v("#")]),t._v(" 原理")]),t._v(" "),v("h2",{attrs:{id:"数据页"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#数据页"}},[t._v("#")]),t._v(" 数据页")]),t._v(" "),v("h4",{attrs:{id:"_1、数据页的组成"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1、数据页的组成"}},[t._v("#")]),t._v(" 1、数据页的组成")]),t._v(" "),v("p",[t._v("  MySQL的数据是以"),v("strong",[t._v("页")]),t._v("为单位，进行内存和磁盘的交互的。那么页中的数据是如何分布和管理的，页的数据结构是怎样的。")]),t._v(" "),v("p",[t._v("  数据页主要由页头、虚记录、记录堆、自由空间链表、未分配空间、slot插槽、页尾组成。")]),t._v(" "),v("p",[t._v("  （1）页头。记录页面的控制信息，占56字节。包括页的左右兄弟页面指针，页面空间使用情况等。")]),t._v(" "),v("p",[t._v("  （2）虚记录。包含最小虚记录，比页内最小主键还小。最大虚记录，比业内最大主键还大。判断一条数据是否在页面内，也就是判断是否在虚记录范围之内。")]),t._v(" "),v("p",[t._v("  （3）记录堆。行记录存储区，分为有效记录和已删除记录两种类型。")]),t._v(" "),v("p",[t._v("  （4）自由空间链表。已删除记录组成的链表。插入数据时，优先复用该块存储空间。")]),t._v(" "),v("p",[t._v("  （5）未分配空间。页面未使用的存储空间。")]),t._v(" "),v("p",[t._v("  （6）页尾。页面最后部分，占8个字节。主要存储页面的校验信息。")]),t._v(" "),v("h4",{attrs:{id:"_2、页中的数据如何保证有序性"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2、页中的数据如何保证有序性"}},[t._v("#")]),t._v(" 2、页中的数据如何保证有序性")]),t._v(" "),v("p",[t._v("  保证数据有序，通常有两种方式。一种是物理有序，另一种是逻辑有序。")]),t._v(" "),v("p",[v("strong",[t._v("  物理有序")]),t._v("。可以类比数组。当插入三条主键分别为10、9、8的数据时，需要移动数据行来保持数据的有序。删除数据时，也要移动数据行将空缺填充上。MySQL的数据都是存储在磁盘上的，移动数据增加了大量的写IO成本，因此写入性能低。虽然保证了数据的物理有序，但由于数据是不定长的。因此也无法使用二分法查询数据。")]),t._v(" "),v("p",[v("strong",[t._v("  逻辑有序")]),t._v("。当插入数据时，只需要分配一块存储空间，然后用链表串起来即可。避免了移动数据行，写入性能高。但使用链表查询数据时，只能遍历该链表，性能较差。")]),t._v(" "),v("p",[t._v("  MySQL使用的是"),v("strong",[t._v("逻辑有序保证数据的有序性")]),t._v("，虽然链表的查询性能较差，但是还有优化的空间。最重要的是"),v("strong",[t._v("保证写入的高性能")]),t._v("，减少写IO的压力，因此几乎没有人使用物理有序。")]),t._v(" "),v("h4",{attrs:{id:"_3、插入策略"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3、插入策略"}},[t._v("#")]),t._v(" 3、插入策略")]),t._v(" "),v("p",[t._v("  这些被删除的数据行被称为空洞（占用的存储空间很大，但有效数据却很少。对于频繁写入删除的表，要定期做一下收缩。由于数据都是不定长的，因此怎么着也会产生一些空洞）。")]),t._v(" "),v("p",[t._v("  当插入数据时，通过自由空间链表优先复用这些删除的空间。")]),t._v(" "),v("h4",{attrs:{id:"_4、查询"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4、查询"}},[t._v("#")]),t._v(" 4、查询")]),t._v(" "),v("p",[t._v("  通过slot槽位，将一个长链表分成多个子链表。多了slot槽位在物理上是连续的，可以做近似二分查找。与跳表的原理很像。")])])}),[],!1,null,null,null);_.default=s.exports}}]);