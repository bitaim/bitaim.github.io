(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{261:function(t,v,_){"use strict";_.r(v);var a=_(0),s=Object(a.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"库存设计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#库存设计"}},[t._v("#")]),t._v(" 库存设计")]),t._v(" "),_("p",[t._v("  电商系统，商品有多种属性，颜色、尺码等，那么库存设计要具体到小的属性。")]),t._v(" "),_("p",[t._v("  商品的每一项细分，我们可以称之为SKU（最小存货单位），每一个SKU对应一份库存。"),_("strong",[t._v("分得越细，在库存扣减时锁的粒度越细，对系统的性能影响越小")]),t._v("。")]),t._v(" "),_("h3",{attrs:{id:"用户下单"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#用户下单"}},[t._v("#")]),t._v(" 用户下单")]),t._v(" "),_("p",[t._v("  用户下单时由于订单生成之后需要预定一定的库存，保证该订单能发货，所有需要增加对应商品的冻结库存。")]),t._v(" "),_("p",[t._v("  一般考虑在两个节点增加冻结库存，一个是在"),_("strong",[t._v("生成订单")]),t._v("时，另一个是在"),_("strong",[t._v("付款成功")]),t._v("时。")]),t._v(" "),_("p",[t._v("  对于库存有限，时间紧迫的下单场景来说，比如"),_("strong",[t._v("秒杀场景")]),t._v("。在付款成功时增加冻结库存会比较合理，因为未付款的订单会影响到其他人购买这款商品。")]),t._v(" "),_("p",[t._v("  对于常规场景来说，在生成订单时占用库存会比较好，否则会影响用户的下单体验。但是一定要有系统系统自动取消订单的功能以便释放冻结库存。")]),t._v(" "),_("h3",{attrs:{id:"确认发货"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#确认发货"}},[t._v("#")]),t._v(" 确认发货")]),t._v(" "),_("p",[t._v("  确认发货的动作可以是ERP订单出库的时候自动确认发货，也可以是手动确认发货。无论哪种场景，只要触发确认发货动作，均需要扣减总库存，同时扣减冻结库存。")]),t._v(" "),_("h3",{attrs:{id:"取消订单"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#取消订单"}},[t._v("#")]),t._v(" 取消订单")]),t._v(" "),_("p",[t._v("  在提交订单，未付款成功之前可以取消订单，取消订单时需要扣减冻结库存。")]),t._v(" "),_("h3",{attrs:{id:"申请退款"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#申请退款"}},[t._v("#")]),t._v(" 申请退款")]),t._v(" "),_("p",[t._v("  若系统定义为商品付款后，发货前可以申请退款的情况下，退款成功则需要扣减冻结库存。")]),t._v(" "),_("h3",{attrs:{id:"申请退货"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#申请退货"}},[t._v("#")]),t._v(" 申请退货")]),t._v(" "),_("p",[t._v("  若系统定义为商品发货后，可以进行申请退货的情况下，退款成功且供应商已收货的情况下需要增加总库存（商家操作“确认收货”或系统自动确认收货）。")]),t._v(" "),_("h2",{attrs:{id:"库存字段设计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#库存字段设计"}},[t._v("#")]),t._v(" 库存字段设计")]),t._v(" "),_("p",[t._v("**  总库存：**供应商仓库该商品的实际库存。")]),t._v(" "),_("p",[t._v("**  冻结（锁定）库存：**订单临时占用的库存，可以通过订单取消或订单发货等情况进行释放。")]),t._v(" "),_("p",[t._v("**  可用库存：**即总库存 - 冻结库存，一般指在前端显示用户可下单的最大数量。")]),t._v(" "),_("h2",{attrs:{id:"库存扣减"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#库存扣减"}},[t._v("#")]),t._v(" 库存扣减")]),t._v(" "),_("p",[_("strong",[t._v("1、下单减库存")])]),t._v(" "),_("p",[t._v("  在用户提交订单时，进行库存预占。")]),t._v(" "),_("p",[t._v("  数据表明用户提交订单不支付的占比是非常小的，给用户预留库存的时间为30分钟，超过30分钟不支付订单自动取消，预占的库存自动释放。")]),t._v(" "),_("p",[_("strong",[t._v("2、支付减库存")])]),t._v(" "),_("p",[t._v("  在用户支付时，进行库存预占。")]),t._v(" "),_("p",[t._v("  会导致大量用户支付失败，严重影响用户体验，就像抢购小米手机一样，明明创建了订单却支付失败。")])])}),[],!1,null,null,null);v.default=s.exports}}]);